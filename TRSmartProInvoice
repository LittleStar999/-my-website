<!DOCTYPE html>
<html>
<head>
  <title>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 30px; }
    input { padding: 10px; width: 80%; font-size: 18px; margin: 10px 0; }
    button { padding: 10px 20px; font-size: 18px; background: #06C755; color: white; border: none; border-radius: 5px; }
    .logo {
      width: 150px;
      height: auto;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <!-- ‚úÖ ‡πÇ‡∏•‡πÇ‡∏Å‡πâ PEA -->
  <img class="logo" src="https://img2.pic.in.th/pic/15936660_1523306937698774_8325876277849390923_o.jpg" alt="PEA Logo" border="0"/>
 
  <h2>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏´‡∏°‡πâ‡∏≠‡πÅ‡∏õ‡∏•‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡∏Å‡∏ü‡∏†.‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏ß‡∏¥‡∏ä‡∏±‡∏¢</h2>
  <h3>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü 11 ‡∏´‡∏•‡∏±‡∏Å ‡πÄ‡∏ä‡πà‡∏ô 20019999444 ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏ö‡∏¥‡∏•‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü </h3>
  <h4>(‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡πÄ‡∏•‡∏Ç 0 ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏Ç 2 ‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å) </h4>
  <input type="text" id="meterId" placeholder="‡πÉ‡∏™‡πà‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü 11 ‡∏´‡∏•‡∏±‡∏Å" maxlength="11" />
  <br>
  <button onclick="submit()">‡∏Å‡∏î‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</button>

  <script>
    async function submit() {
      const meterId = document.getElementById('meterId').value.trim();
       alert("CLICKED");  // üëà ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°
      
      if (!/^\d{11}$/.test(meterId)) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü 11 ‡∏´‡∏•‡∏±‡∏Å');
        return;
      }

      await liff.init({ liffId: "2007700241-VxL0MwoK" });

      const profile = await liff.getProfile();
      const userId = profile.userId;

      // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Apps Script
      fetch("https://script.google.com/macros/s/AKfycbyyxkHkHpmeja3UHJVCcSO8C0BxzUSGa409RPEfBtEcZgf7V85nODdXEljX1jvTyNtqhg/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          userId: userId,
          meterId: meterId
        })
      }).then(res => {
        alert('‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏™‡πà‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ú‡πà‡∏≤‡∏ô LINE ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ô‡πÑ‡∏°‡πà‡∏ä‡πâ‡∏≤');
        liff.closeWindow(); // ‡∏õ‡∏¥‡∏î LIFF Page
      });
    }
  </script>
</body>
</html>
